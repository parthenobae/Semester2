{% extends "layout.html" %}

{% block content %}
    <div class="content-section">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h3 class="mb-0">Team: {{ team.name }}</h3>
        </div>

        <p><strong>Team ID:</strong> {{ team.id }}</p>
    </div>
    <div class="content-section">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h3 class="mb-0">Team Members</h3>
            <button class="btn btn-success btn-sm" type="button" data-toggle="collapse" data-target="#addMemberForm" aria-expanded="false" aria-controls="addMemberForm">
                <i class="fas fa-user-plus"></i> Add Member
            </button>   
        </div>

        <!-- Add Member Form (collapsible) -->
        <div class="collapse mb-3" id="addMemberForm">
            <div class="card card-body">
                <form method="POST" action="">
                    {{ form.hidden_tag() }}
                    <div class="form-group">
                        {{ form.userid.label(class="form-label") }}
                        {{ form.userid(class="form-control", placeholder="Enter User id") }}
                    </div>
                    <div class="form-group">
                        {{ form.submit(class="btn btn-outline-info") }}
                    </div>
                </form>
            </div>
        </div>

        {% if users %}
            <ul class="list-group">
                {% for member in users %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <img src="{{ url_for('static', filename='profile_pics/' + member.image_file) }}" 
                                alt="Member Image" 
                                class="rounded-circle mr-2" 
                                style="width: 30px; height: 30px; object-fit: cover;">
                            <strong>{{ member.username }}</strong> <small class="text-muted ml-2">{{ member.email }}</small>
                        </div>
                        <a class="nav-item nav-link color-  red" href="{{ url_for('users.delete_user', user_id=member.id, team_id=team.id)}}">Delete</a>
                        <span class="badge badge-secondary">{{ member.role if member.role else 'Member' }}</span>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <div class="alert alert-info">
                This team currently has no members.
            </div>
        {% endif %}
    </div>
    <div class="content-section">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h3 class="mb-0">Cases Assigned</h3>
            <button class="btn btn-success btn-sm" type="button" data-toggle="collapse" data-target="#addCaseForm" aria-expanded="false" aria-controls="addCaseForm">
                <i class="fas fa-user-plus"></i> Add Case
            </button>   
        </div>

        <!-- Add Case Form (collapsible) -->
        <div class="collapse mb-3" id="addCaseForm">
            <div class="card card-body">
                <form method="POST" action="">
                    {{ form1.hidden_tag() }}
                    <div class="form-group">
                        {{ form1.case_name.label(class="form-label") }}
                        {{ form1.case_name(class="form-control", placeholder="Enter Case Name") }}
                    </div>
                    <div class="form-group">
                        {{ form1.description.label(class="form-label") }}
                        {{ form1.description(class="form-control", placeholder="Case Description") }}
                    </div>
                    <div class="form-group">
                        {{ form1.report_date.label(class="form-label") }}
                        {{ form1.report_date(class="form-control", placeholder="Report Date") }}
                    </div>
                    <div class="form-group">
                        {{ form1.status.label(class="form-label") }}
                        {{ form1.status(class="form-control", placeholder="Status") }}
                    </div>
                    <div class="form-group">
                        {{ form1.location.label(class="form-label") }}
                        {{ form1.location(class="form-control", placeholder="Enter Location") }}
                    </div>
                    <div class="form-group">
                        {{ form1.submit(class="btn btn-outline-info") }}
                    </div>
                </form>
            </div>
        </div>

        {% if cases %}
            <ul class="list-group">
                {% for case in cases %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <strong>{{ case.name }}</strong> <small class="text-muted ml-2">{{ case.report_date }}</small>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <div class="alert alert-info">
                This team currently has no cases.
            </div>
        {% endif %}
    </div>
{% endblock content %}
